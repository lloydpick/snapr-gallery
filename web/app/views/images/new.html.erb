<%= error_messages_for :image %>

<% form_for(:image, :url => { :action => 'create' }, :html => { :multipart => true }) do |f| -%>
    <p>
        <label for="image">Upload an Image:</label>
        <%= f.file_field :uploaded_data %>
    </p>
    <p>
        <label for="title">Title:</label>
        <%= text_field "photo", "title" %>
    </p>
    <p>
        <label for="caption">Caption:</label>
        <%= text_field "photo", "caption" %>
    </p>
    <p>
        <label for="is_visible">Visible:</label>
        True<%= radio_button_tag "photo[is_visible]", "true", true, :id => 'photo_is_visible' %>
        &nbsp;&nbsp;&nbsp;&nbsp;
        False<%= radio_button_tag "photo[is_visible]", "false", false, :id => 'photo_is_visible' %>
    </p>
    <%= hidden_field "photo", "position", { :value => @next } %>
  <p>
    <%= submit_tag 'Create' %>
  </p>
<% end -%>
<br />
<hr />

<p>SWFUpload button allows uploading more than one image at a time. This section adapted from index.php in the swfupload application demo. In a final application the Graceful Degradation plugin would show or hide the traditional or swfupload divisions based on whether the swfupload program successfully initialized.</p>

<script type='text/javascript'>
  var swfu;

  window.onload = function () {
    swfu = new SWFUpload({
      // Create the custom swfupload_photos_path in the routes.rb file
      upload_url : '<%= url_for :action => "swfupload", :id => current_user.id -%>',
      flash_url : '/assets/swfupload_f9.swf',

      file_size_limit : '5 MB',
      file_types : '*.jpg',
      file_types_description : 'JPG Images',
      file_upload_limit : '0',

      file_queue_error_handler : fileQueueError,
      file_dialog_complete_handler : fileDialogComplete,
      upload_progress_handler : uploadProgress,
      upload_error_handler : uploadError,
      upload_success_handler : uploadSuccess,
      upload_complete_handler : uploadComplete,

      custom_settings : { 
        upload_target : 'divFileProgressContainer'
      },

      debug: false

    });
  };
</script>

<div style="margin: 0px 10px;">
	<div>
		<form>
			<button id="btnBrowse" type="button" style="padding: 5px;" onclick="swfu.selectFiles(); this.blur();"><img src="/images/page_white_add.png" style="padding-right: 3px; vertical-align: bottom;">Select Images <span style="font-size: 7pt;">(2 MB Max)</span></button>
		</form>
	</div>
	<div id="divFileProgressContainer" style="height: 75px;"></div>
	<div id="thumbnails"></div>
</div>

